---
title: "Fisher's alpha is not a valid metric of biodiversity in tropical forests"
# Output formats
format:
  stylisharticle-pdf:
    keep-tex: true
    # Color example, see "Text color"
    header-includes:
      \definecolor{grey}{RGB}{191, 191, 191}
  stylisharticle-html:
    # Color example, see "Text color"
    css: colors.css
# Authors (https://quarto.org/docs/journals/authors.html#author-schema)
author:
  - name: Eric Marcon
    affiliations:
      - name: AgroParisTech
        department: UMR Amap
        city: Montpellier
        country: France
        postal-code: 34000
      - Demo Journal
    orcid: 0000-0002-5249-321X
    email: eric.marcon@agroparistech.fr
    url: https://ericmarcon.github.io/
# Abstract and Keywords
abstract: |
  Fisher's alpha should not be used to assess the diversity of tropical forest tree species at the local and regional scales.
keywords: [template, demo]
# Bibliography
reference-section-title: References
bibliography: references.bib
biblio-style: chicago
# Language
lang: en-GB
# Code options 
# https://quarto.org/docs/computations/execution-options.html#output-options
execute:
  # show code chunk output
  include: true
  # Show the code in the output
  echo: false
  # Show warnings
  warning: false
  # Cache code results
  cache: true
  # option messages is in the Option chunk for R
# Template specific
journalinfo: "Publication reference"
archive: "DOI: xxx/xx"
keywordlabel: Keywords
corrauthorlabel: Corresponding Author
---

```{r}
#| label: DoNotModify
#| include: false
### Utilities for R. 
# Do not modify unless you don't use R: then, delete this chunk.
# Installation of R packages if necessary
install_packages <- function(packages) {
  invisible(
    sapply(
      packages, 
      FUN = function(package) {
        if (!package %in% installed.packages()[, 1]) {
          install.packages(package, repos = "https://cran.rstudio.com/")
        }
      }
    )
  )
}

# Basic packages
install_packages(c("knitR", "formatR", "kableExtra"))

# Chunk font size hook: allows size='small' or any valid Latex font size in chunk options
def.chunk.hook <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(
  chunk = function(x, options) {
    x <- def.chunk.hook(x, options)
    ifelse(
      options$size == "normalsize", 
      yes = x,
      no = paste0("\n \\", options$size, "\n\n", x, "\n\n \\normalsize")
    )
  }
)
```

```{r}
#| label: Options
#| include: false
### Customized R options for this document
# Delete this chunk if you don't use R

# Add necessary packages here
packages <- c("tidyverse", "divent", "vegan")
# Install them
install_packages(packages)

# knitr options (https://yihui.org/knitr/options/)
knitr::opts_chunk$set(
  # Messages from packages
  message = FALSE,
  # Code chunk automatic format if tidy is TRUE
  tidy = TRUE, 
  # Tidy code options: remove blank lines and cut lines after 50 characters
  tidy.opts = list(blank = FALSE, width.cutoff = 50),
  # Font size in PDF output
  size = "scriptsize", 
  # Select PDF figures in PDF output if PDF file exists beside PNG file
  knitr.graphics.auto_pdf = TRUE
)
# Text width of R functions output
options(width = 50)

# ggplot style
library("tidyverse")
theme_set(theme_bw())
theme_update(
  panel.background = element_rect(fill = "transparent", colour = NA),
  plot.background = element_rect(fill = "transparent", colour = NA)
)
knitr::opts_chunk$set(dev.args = list(bg = "transparent"))

# Random seed
set.seed(973)
```

# Introduction

Tropical evergreen forests such as the Amazon host thousand of tree species that are difficult to assess.
Even though their biodiversity does not reduce to trees, understanding their distribution is a necessary step to both understand the functioning of the ecosystem and develop conservation policies.
The relation between diversity and area has long been questioned by ecologists.
It must be addressed according to the considered scale.
At the local scale, i.e. when the distribution of species can be considered as unique, species accumulation curves (SAC) are built from it with well-known statistical tools.
At regional scales, i.e. when different communities are included and beta-diversity comes into play, species-area relationships properly speaking are derived from ecological theory with empirical support.
Whatever the scale, the number species increases with the area or the number of individuals, making it a challenge to correctly describe biodiversity with a number: species richness (i.e. the number of species) is the simplest candidate, but its application may be ambiguous.

Fisher's log-series was derived originally from the distribution of tropical butterflies.
It is formulated as a species-abundance relationship that links the number of species to the number of individuals with a single parameter, called $\alpha$.
Fisher's $\alpha$ is thus an ideal candidate to measure diversity since it overcomes the previous issue: it is scale-independent, if the actual species distribution is a log-series.
After a long period of relative obscurity, $\alpha$ made a comeback after the development of Hubbell's neutral theory since the metacommunity is distributed in log-series whose $\alpha$ equals $\theta$, the fundamental number of biodiversity.
Although the log-series applies neither to the local or regional scale according to the neutral theory, it became popular to describe the diversity of forest trees, probably for its simplicity.
Summarizing a species distribution by a statistics that does not apply to it is questionable.
The aim of this paper is to show that $\alpha$ actually does not measure diversity unambiguously, neither at local nor at regional scales, and should be limited to the metacommunity scale.
It is organised as follows: Fisher's $\alpha$ fundamentals are first recalled;its use at the different scales is then discussed before concluding about its applicability.

# Fisher's $\alpha$ fundamentals

$$
  S(n) = \alpha \ln \left( 1 + \frac{n}{\alpha} \right).
$$ {#eq-fisheralpha}

For $n >> \alpha$, equation @eq-fisheralpha can be simplified to $S(n) \approx \alpha ln(\alpha) + \alpha ln(n)$, i.e. the number of observed species is linearly related to the logarithm of the sample size.
The slope of the line is $\alpha$ and the intercept is $\alpha ln(\alpha)$.

Based on @eq-fisheralpha, the species accumulation curve has two parts when it is drawn with a logarithmic X-axis: first, as $n$ is not great enough for the approximation, it is convex, then it is linear.

# Local scale

```{r}
#| label: fig-BCI_accum
#| fig-cap: Species Accumulation Curve of BCI dataset
library("tidyverse")
library("divent")
library("vegan")
data(BCI)
BCI %>% 
  colSums() %>% 
  as_abundances() %>% 
  mutate(site = "BCI") %>% 
  accum_hill() %>% 
  {. ->> BCI_accum} %>% 
  autoplot() +
  labs(y = "Richness") +
  theme(legend.position = "none")
```

Sampling the local community results in a species accumulation curve, studied in depth by @Gotelli2001.
The number of species increases step by step, when the next sampled individual belongs to a new one.
This stochastic *collector's curve* is of less interest than its expectation, assuming individuals are sampled independently: only that smoothed curve is called the SAC.
It is actually computed by rarefaction of the distribution of the whole sample.
It is usually plotted on continuous scales.
Between sample sizes $n$ and $n + 1$, the slope of the curve is the probability for the next individual to belong to a new species: it decreases until all species have been discovered: so, it is concave.

@fig-BCI_accum shows the SAC of the Barro Colorado Island 50-ha forest plot based on the data provided by the *vegan* R package.
The number of species increases with sample size and does not reach an asymptote despite the huge sampling effort.
To allow comparing diversity with other sites, two strategies are possible: estimated asymptotic diversity or standardize the sampling effort.

The asymptotic diversity here is the number of species that would be observed if the sample reached the necessary size to encompass all species of the community.
In hyperdiverse ecosystems such as evergreen forests, the asymptotic community generally does not exist in the field because of environmental variations: increasing the size of the sample results in sampling in different communities.
Thus, the asymptotic estimators of diversity correspond to theoretical asymptotic communities that do not necessarily exist: it is a feature of a model.
This is an argument for avoiding them, but the definition of the local community is already a model, in the sense that local environmental variations imply that the distribution of species varies in turn: the heterogeneity of the community considered as negligible corresponds to necessary decisions to model the reality.

An alternative consists in standardizing the sample site, in general to allow comparing different communities whose inventories are not large enough to allow a reliable estimation of asymptotic diversity.
Exact rarefaction formulas are available to calculate the number of tree species at any sampling level smaller than the actual sample, and estimators allow extrapolating the diversity up to a limited level, around twice the actual sample size.

# Regional scale

# Discussion

Rarefaction \<-\> rare species vanish.
