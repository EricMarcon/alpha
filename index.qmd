---
title: "Fisher's alpha is not a valid metric of biodiversity in tropical forests"
# Output formats
format:
  stylisharticle-pdf:
    keep-tex: true
    # Color example, see "Text color"
    header-includes:
      \definecolor{grey}{RGB}{191, 191, 191}
  stylisharticle-html:
    # Color example, see "Text color"
    css: colors.css
# Authors (https://quarto.org/docs/journals/authors.html#author-schema)
author:
  - name: Eric Marcon
    affiliations:
      - name: AgroParisTech
        department: UMR Amap
        city: Montpellier
        country: France
        postal-code: 34000
    orcid: 0000-0002-5249-321X
    email: eric.marcon@agroparistech.fr
    url: https://ericmarcon.github.io/
# Abstract and Keywords
abstract: |
  Fisher's alpha should not be used to assess the diversity of tropical forest tree species at the local and regional scales.
keywords: [Fisher's alpha, biodiversity, tropical forests]
# Bibliography
reference-section-title: References
bibliography: references.bib
biblio-style: chicago
# Language
lang: en-GB
# Code options 
# https://quarto.org/docs/computations/execution-options.html#output-options
execute:
  # show code chunk output
  include: true
  # Show the code in the output
  echo: false
  # Show messages
  message: false
  # Show warnings
  warning: false
  # Cache code results
  cache: true
# Template specific
journalinfo: "Preprint"
archive: "DOI: xxx/xx"
keywordlabel: Keywords
corrauthorlabel: Corresponding Author
---

```{r}
#| label: DoNotModify
### Utilities for R. 
# Do not modify unless you don't use R: then, delete this chunk.
# Installation of R packages if necessary
install_packages <- function(packages) {
  invisible(
    sapply(
      packages, 
      FUN = function(package) {
        if (!package %in% installed.packages()[, 1]) {
          install.packages(
            package, 
            repos = "https://cran.rstudio.com/", 
            quiet = TRUE
          )
        }
      }
    )
  )
}

# Basic packages
install_packages(c("knitR", "formatR", "kableExtra"))

# Chunk font size hook: allows size='small' 
# or any valid Latex font size in chunk options
def.chunk.hook <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(
  chunk = function(x, options) {
    x <- def.chunk.hook(x, options)
    ifelse(
      options$size == "normalsize", 
      yes = x,
      no = paste0("\n \\", options$size, "\n\n", x, "\n\n \\normalsize")
    )
  }
)
```

```{r}
#| label: Options
### Customized R options for this document
# Delete this chunk if you don't use R

# Add necessary packages here
packages <- c("tidyverse", "divent", "vegan", "untb", "ggpubr")
# Install them
install_packages(packages)

# knitr options (https://yihui.org/knitr/options/)
knitr::opts_chunk$set(
  # Code chunk automatic format if tidy is TRUE
  tidy = TRUE, 
  # Tidy code options: remove blank lines and cut lines after 50 characters
  tidy.opts = list(blank = FALSE, width.cutoff = 50),
  # Font size in PDF output
  size = "scriptsize", 
  # Select PDF figures in PDF output if PDF file exists beside PNG file
  knitr.graphics.auto_pdf = TRUE
)
# Text width of R functions output
options(width = 50)

# ggplot style
library("tidyverse")
theme_set(theme_bw())
theme_update(
  panel.background = element_rect(fill = "transparent", colour = NA),
  plot.background = element_rect(fill = "transparent", colour = NA)
)
knitr::opts_chunk$set(dev.args = list(bg = "transparent"))

# Random seed
set.seed(973)
```

# Introduction

Tropical evergreen forests such as the Amazon host thousand of tree species that are difficult to assess [@TerSteege2013].
Even though their biodiversity does not reduce to trees, understanding their distribution is a necessary step to both understand the functioning of the ecosystem [@Liang2016] and develop conservation policies [@Strange2024].

The relation between diversity and area has long been questioned by ecologists [@MacArthur1967; @Plotkin2000a].
It must be addressed according to the considered scale [@Grilli2012].
At the local scale, i.e. when the distribution of species can be considered as unique, species accumulation curves (SAC) are built from it with well-known statistical tools [@Gotelli2001; @Chao2014].
At regional scales, i.e. when different communities are included and beta-diversity comes into play, species-area relationships (SAR) properly speaking are derived from ecological theory [@Harte1999] with empirical support [@Arrhenius1921].
Whatever the scale, the number species increases with the area or the number of individuals, making it a challenge to correctly describe biodiversity with a number: species richness (i.e. the number of species) is the simplest candidate, but its application may be ambiguous.

Fisher's log-series [@Fisher1943] was derived originally from the distribution of tropical butterflies.
It is formulated as a species-abundance relationship that links the number of species to the number of individuals with a single parameter, called $\alpha$.
Fisher's $\alpha$ is thus an ideal candidate to measure diversity since it overcomes the previous issue: it is scale-independent if the actual species distribution is a log-series.
After a long period of relative obscurity, $\alpha$ made a comeback following the development of Hubbell's neutral theory [@Hubbell2001] since the metacommunity is distributed in log-series whose $\alpha$ equals $\theta$, the fundamental number of biodiversity.
Although the log-series applies neither to the local scale according to the neutral theory, it became popular [@Duque2017] to describe the diversity of forest trees, probably for its simplicity.
Summarizing a species distribution by a statistics that does not apply to it is questionable.
The aim of this paper is to show that $\alpha$ actually does not measure diversity unambiguously, neither at local nor at regional scales, and should be limited to the largest metacommunity.
It is organised as follows: Fisher's $\alpha$ fundamentals are first recalled; its use at the different scales is then discussed before concluding about its applicability.

# Material and methods

## Fisher's $\alpha$ fundamentals

Fisher derived the log-series distribution from a set of assumptions [@Fisher1943].
In his model, all species are distributed completely randomly and independently from each other, i.e. their abundance in a fixed area follows a Poisson distribution.
The intensities of the Poisson distributions of all species follow in turn a gamma distribution with shape parameter (tending to) zero.
Last, the number of species is infinite.
Then, the number of species with non-zero abundance $S(n)$ is linked to the size of the community $n$ through @eq-fisheralpha by a parameter named $\alpha$.
It is called log-series because the number of species is derived as the sum of the number of species with 1 to an infinite number of individuals: this infinite sum appears to be the Taylor series of the logarithm function.

$$
  S(n) = \alpha \ln \left( 1 + \frac{n}{\alpha} \right).
$$ {#eq-fisheralpha}

For $n >> \alpha$, @eq-fisheralpha can be simplified to $S(n) \approx -\alpha ln(\alpha) + \alpha ln(n)$, i.e. the number of observed species is linearly related to the logarithm of the sample size.
The slope of the line is $\alpha$ and the intercept is $-\alpha ln(\alpha)$.

::: {#fig-BCI_accum_logx}
```{r}
#| label: BCI_accum_logx
library("tidyverse")
library("divent")
library("vegan")
data(BCI)
BCI %>% 
  # Sum all plots
  colSums() %>% 
  # Save the vector of abundances
  {. ->> BCI_50ha} %>% 
  # Calculate alpha
  fisher.alpha() ->
  BCI_alpha
 BCI_50ha %>%
  # Declare the object class (divent)
  as_abundances() %>% 
  # Site name
  mutate(site = "BCI") %>% 
  # Accumulation curve up to 2x sample size
  accum_hill(levels = seq_len(2 * sum(BCI_50ha))) %>% 
  # Save the SAC
  {. ->> BCI_accum} %>% 
  # Plot
  autoplot() +
  scale_x_log10() +
  theme(legend.position = "none") +
  labs(y = "Number of Species") +
  # Accumulation curve of a log-series
  geom_function(fun = \(n) {BCI_alpha * log(1 + n / BCI_alpha)}, col = "black")
```

Accumulation curve of a log-series distribution (black) with Fisher's $\alpha$ equal to `r round(BCI_alpha)` and of BCI (red).
The intersection of the dotted lines corresponds to the number of trees and of species of BCI 50-ha inventory the value of $\alpha$ is derived from.
:::

Based on @eq-fisheralpha, the species accumulation curve has two parts when plotted on a logarithmic x-axis: first, as $n$ is not great enough for the approximation, it is convex, then it is linear (@fig-BCI_accum_logx).

The distribution can also be represented as a rank-abundance curve (@fig-BCI_RAC).
A characteristic feature of the log-series is that the abundance of species decreases linearly with their rank, except for the most abundant ones.

::: {#fig-BCI_RAC}
```{r}
#| label: BCI_RAC
BCI_50ha %>%
  fit_rac(distribution = "lseries") %>% 
  pluck("rac") ->
  BCI_ls_RAC
BCI_50ha %>%
  # Declare the object class (divent)
  as_abundances() %>% 
  autoplot() + 
  geom_line(
    data  = BCI_ls_RAC,
    aes(x = rank, y = abundance)
  )
```

Rank-abundance curve of a log-series distribution (black) and of BCI (red dots).
Species are ordered by decreasing abundance.
The log-series is the best fit to BCI data ($\alpha =$ `r round(BCI_alpha)`).
:::

## Example data

To illustrate the estimation of Fisher's $\alpha$ at the local scale, the BCI data set available in the R [@R] package vegan [@vegan] will be used.
It was published by @Condit2002.
The data consist of 50 one-hectare plots of tropical evergreen forest where all trees above 10 cm DBH (diameter at breast height) were recorded.
The forest is located on Barro Colorado Island in the canal of Panama.
It has been studied by many authors [@Muller-Landau2024], allowing to compare the results of this paper to a large literature, even though the metrics of diversity may vary somehow since the forest was inventoried at different dates, including trees above 1 cm DBH.
The BCI dataset used here contains `r sum(BCI)` trees above 10 cm DBH in `r ncol(BCI)` species.

The regional dataset is a part of the GuyaDiv network [@Engel2015] located in French Guiana, published in @Marcon2024.
It contains 68 one-hectare plots located in 21 sites scattered over the territory.
They were used to estimate the number of tree species in French Guiana: around 2200 in 80,000 km^2^ of continuous, tropical evergreen forest on the north-eastern edge of the Amazon.

# Local scale

::: {#fig-BCI_accum}
```{r}
#| label: BCI_accum
BCI_S_estimate <- div_richness(BCI_50ha, as_numeric = TRUE)
BCI_S_1ha <- round(
  div_richness(
    BCI_50ha, 
    level = round(sum(BCI) / 50), 
    as_numeric = TRUE
  )
)
BCI_accum %>%
  autoplot() +
  labs(y = "Richness") +
  theme(legend.position = "none") +
  # Asymptotic estimator
  geom_hline(
    yintercept = BCI_S_estimate, 
    linetype = 3
  ) +
  # Accumulation curve of a log-series
  geom_function(fun = \(n) {BCI_alpha * log(1 + n / BCI_alpha)}, col = "black")
```

Species Accumulation Curve of BCI extrapolated up to twice the sample size.
The dotted lines correspond to the 50-ha inventory.
The horizontal, dotred line, is the estimated asymptotic number of species, calculated with the jackknife estimator of order 1 [@Burnham1978].
The black curve is the SAC of the log-series with $\alpha$ equal to `r round(BCI_alpha)`.
:::

Sampling the local community results in a species accumulation curve, studied in depth by @Gotelli2001.
The number of species increases step by step, when the next sampled individual belongs to a new one.
This stochastic *collector's curve* is of less interest than its expectation, assuming individuals are sampled independently: only that smoothed curve is called the SAC.
It is actually computed by rarefaction of the distribution of the whole sample [@Chao2014].
It is usually plotted on continuous scales.
Between sample sizes $n$ and $n + 1$, the slope of the curve is the probability for the next individual to belong to a new species [@Grabchak2016]: it decreases until all species have been discovered, so it is concave.

@fig-BCI_accum shows the SAC of the Barro Colorado Island 50-ha forest plot.
The number of species increases with sample size and does not reach an asymptote despite the huge sampling effort.
To allow comparing diversity with other sites, two strategies are possible: estimate asymptotic diversity or standardize the sampling effort [@Chao2012b].

The asymptotic diversity here is the number of species that would be observed if the sample reached the necessary size to encompass all species of the community.
In hyperdiverse ecosystems such as evergreen forests, the asymptotic community generally does not exist in the field because of environmental variations: increasing the size of the sample results in sampling in different communities.
Thus, the asymptotic estimators of diversity correspond to theoretical asymptotic communities that do not necessarily exist: it is a feature of a model.
This is an argument for avoiding them, but the definition of the local community is already a model [@Stroud2015], in the sense that local environmental variations imply that the distribution of species varies in turn: the heterogeneity of the community considered as negligible corresponds to necessary decisions to model the reality.
The estimated number of species is `r BCI_S_estimate`.

An alternative consists in standardizing the sample site, in general to allow comparing different communities whose inventories are not large enough to allow a reliable estimation of asymptotic diversity.
Exact rarefaction formulas are available to calculate the number of tree species at any sampling level smaller than the actual sample, and estimators allow extrapolating the diversity up to a limited level, around twice the actual sample size [@Chao2014].
The expected number of species in one hectare of BCI, actually based on the average number of trees per hectare, is `r BCI_S_1ha`.

In contrast, Fisher's $\alpha$ does not depend on the sample size as soon as $n \gg \alpha$, which is always true in forest inventories.
Thus, it appears to be an ideal, universal metric of biodiversity, allowing to compare it across sites of different sizes.
The issue is that the distribution of tropical forest tree communities is not a log-series.
@Hubbell2001 named it the zero-sum multinomial distribution; its mathematical derivation is due to @Volkov2003.
It is close to a log-normal distribution [@McGill2003], but differs from by a greater abundance of the rarest species.

This discrepancy has two consequences: from a theoretical point of view, $\alpha$ is the parameter of a distribution that is not observed; from an empirical point of view, its estimation is inconsistent.

The theoretical issue does not require much more argumentation.
Applying an appropriate model to describe the distribution of species is similar to trying to describe the size of a rectangle by the single length of its side, assuming it is a square.

The empirical question deserves further elaboration, based on the BCI dataset for clarity.
The basic argument is that the actual distribution is not so different from a log-series that the advantages of summarizing it by $\alpha$ are not worth it.
Several R packages allow estimating $\alpha$ from a vector of abundances (see Appendix 1 for details).
Most of them (such as `vegan::fisher.alpha`) just solve @eq-fisheralpha, i.e. they only rely on the total abundance and number of species, ignoring the distribution.
More elaborate ones (such as `sads::fitls`) find the value of $\alpha$ that maximizes the likelihood of the distribution assuming it is a log-series.
When applied to the BCI dataset, both return the same estimation: `r round(BCI_alpha)`.
Its poor empirical fit is illustrated by @fig-BCI_accum and @fig-BCI_accum_logx.

::: {#fig-BCI_size}
```{r}
#| label: BCI_size
# Sample `sample_size` sites in an abundance table, group them and compute alpha
alpha_sub <- function(sample_size, abd) {
  # Draw the rows of to sample in the table
  the_sample <- sample(seq_len(nrow(abd)), size = sample_size) 
  # Sample them
  abd[the_sample, ] %>% 
    # Make an abundances object (package divent)
    as_abundances() %>% 
    # Equal weights
    mutate(weight = 1) %>% 
    # Merge the rows
    metacommunity() %>% 
    # Numeric vector
    as.numeric() %>% 
    # Return alpha
    fisher.alpha()
}

# Sample from 4 to 50ha
sizes <- seq_len(nrow(BCI))[-(1:3)]
# Number of simulations
simulations_n <- 20
# Compute alpha
alphas <- replicate(
  simulations_n, 
  # Caclulate alpha at all sample sizes
  expr = sapply(sizes, FUN = alpha_sub, abd = BCI)
)
# alpha values
tibble(Size = sizes) %>%
  bind_cols(alphas) %>% 
  pivot_longer(cols = !Size) %>% 
  # Plot
  ggplot(aes(x = Size, y = value)) +
  geom_point() +
  scale_x_log10() +
  labs(x = "Sample size", y = "Fisher's alpha") +
  geom_smooth(method = "lm") +
  # Equation
  ggpubr::stat_regline_equation(label.x.npc = "center")
```

Estimation of Fisher's $\alpha$ depending on the number of 1-ha plots of BCI.
The dots are random draws of plot assemblages.
The line is the fit of a linear model relating $\alpha$ to the logarithm of the number of plots.
:::

In contrast with the assumed advantage of $\alpha$, its estimation heavily relies on the sample size.
@fig-BCI_size shows the average estimation of $\alpha$ based on random subsamples of BCI, from 4 to 50ha, repeated `r simulations_n` times.

The estimated value of $\alpha$ decreases from over 40 to approximately 35, with a quite good linear relation between $\alpha$ and the logarithm of the sample size.
Several examples can be found in the literature, e.g. @Duque2017; @Schulte2005, where the dependence of $\alpha$ to sample size is explored either with a statistical or an ecological approach.

Visually, in @fig-BCI_accum_logx, increasing $\alpha$ moves the log-series distribution to the right and increases its slope.
Changing the sample size means changing the intersection point between the accumulation curve and the log-series curve, thus necessarily modifying $\alpha$.
At this stage, there is no real argument to decide whether BCI's $\alpha$ is 35 or 40.

A solution to this problem is to return to the neutral model theory and assume that the local community is not a log-series because of dispersal limitation, i.e. its migration parameter $m$ is not 1.
Then, the parameter to estimate is $\theta$, the fundamental number of biodiversity in the metacommunity BCI belongs to: the metacommunity is distributed as a log-series whose parameter is $\theta$.
This is an elegant solution both theoretically (all assumptions are valid) and empirically (the estimation of $\alpha$ is robust).

@Hubbell2001 [page 293] proposed estimating it by adjusting the rank-abundance curve to the most frequent species in the community, arguing that these species are also the most abundant in the metacommunity.
He found $\theta = 50$.
The same algorithm is applied to the current BCI dataset in Appendix 2: its result is $\theta = 45$.
Both $\theta$ and $m$ can be estimated by likelihood maximization of the local distribution [@Etienne2005] with the untb package [@Hankin2007].
The retained value of $\theta$ is 48.
The consistency of this approach is shown in Appendix 3: $\theta$ and $m$ are estimated from the BCI distribution, then a community of the same size is drawn with these parameters: it is very close to the actual distribution.

This faces two limits.
First, as far as we know, it is not applied in the literature.
Then, it does not exactly describe the diversity of the local community but that of the metacommunity: summarizing BCI by $\theta = 48$ ignores the migration parameter.
Modifying $m$ yields very different distribution, from geometric to log-series [@Hubbell2001].
In other words, $\theta$ only gives a very partial knowledge of the diversity of the local community.

# Regional scale

The regional scale is that of Arrhenius's model [@Arrhenius1921].
Its fundamental difference with the local scale is that several communities are taken into account, involving $\beta$ diversity that can't be addressed directly.
Whereas the computation of the local species accumulation curve was non-parametric, based solely on statistical techniques, the regional species-area relationship follows a power model with parameters $c$ and $z$ ,

$$
  S(A) =c A^z,
$$ {#eq-arrhenius}

where $A$ is the surface area, $c$ a constant that depends on the organisms taken into account and the regional diversity, and $z$ the parameter that relates richness to area.
Assuming that forest communities are saturated, i.e. $n = \rho A$ where $\rho$ is the number of trees per unit area,the number of individuals is proportional to the area, and, since $\ln n \gg \ln \rho$, the model can be rewritten in a linear form:

$$
  \ln\left(S\left(n\right)\right) = k_A + z \ln\left(n\right)
$$ {#eq-arrhenius_log}

where $k_A$ is another constant.

The regional scale is also that of the metacommunity in the neutral model.
The actual size $J_M$ of the metacommunity a local community results from is difficult to address and of little interest in the theory since the important parameter is $\theta$, that combines both $J_m$ and the speciation rate $\nu$.
The important fact here is that, according to the neutral model, metacommunities are distributed in log-series whose $\alpha$ parameter asymptotically tends to $\theta$ when their size increases [@Hubbell2001].

Sampling the metacommunity by a large enough number of plots results in a log-series distribution.
This property allowed estimating the number of species of the Amazon forest [@TerSteege2013] and of all tropical forests of the world [@Slik2015].
Discussing the sampling issues due to the spatial structure of species [@TerSteege2020] or the discrepancies between the empirical and theoretical distributions [@Milton2025] is not the scope of this paper: even ignoring them, the theory is very well supported empirically.

@Gleason1922 refuted Arrhenius's model, arguing that the richness would be far too high for large areas, and proposed a competing model in which the number of species, rather than its logarithm, increased with the logarithm of the area.
Assuming saturation, i.e. $n = \rho A$ where $\rho$ is the number of trees per unit area, and $\ln n \gg \ln \rho$ , it can be rewritten as

$$
   S\left(n\right) = k_G + \alpha \ln\left(n\right),
$$ {#eq-gleason_log}

where $k_G$ is another constant and $\alpha$ the slope of the relation.
This model is actually identical to Fisher's [@Engen1977].

Arrhenius's model benefits from a long theoretical [@Williamson2001; @Harte1999; @Preston1962] and empirical [@Dengler2009; @Triantis2012] support.

A simple argument against Gleason's model is contained in the neutral theory.
Consider a large metacommunity and assume it is distributed as a log-series.
A smaller metacommunity inside it would just be a sample of it in absence of dispersal limitation.
Then both distributions would be identical, i.e. the same log-series with the same parameter $\alpha$: the same Fisher's model would be valid for all subsamples of the largest metacommunity, validating Gleason's model.
Yet, dispersal is limited, i.e. not all species of the largest metacommunity are present in the smaller ones: their diversity is reduced.
Although they are distributed in log-series, their parameter $\alpha$ is smaller.
Thus, the number of species decreases faster with the area than predicted by Gleason's model.

At this stage, we face an apparent paradox: the regional species area relationship follows a power model but a metacommunity is distributed in log-series.
It is solved considering that the metacommunity's $\alpha$ parameter depends on its size.
Again, a smaller metacommunity embedded in the first one does not contain all species because of dispersal limitation.
When the SAR is plotted on a log-log scale, it is linear.
If the y-axis is not in logarithmic scale, it becomes concave.
In this representation (@fig-arrhenius_logx), a log-series species accumulation curve is a straight line (the number of individuals is much greater than $\alpha$) so $\alpha$ increases with area.

::: {#fig-arrhenius_logx}
```{r}
#| label: arrhenius_logx
# Read the data
# Plots
"data/plots.csv" %>% 
  read_csv2() ->
  guyadiv_plots
# Abundances
"data/abundances.csv" %>% 
  read_csv2() ->
  guyadiv_abd
# Estimate alpha
guyadiv_abd %>% 
  # Make an abundances object (package divent)
  rename(site = Plot) %>% 
  as_abundances() %>% 
  # Equal weights
  mutate(weight = 1) %>% 
  # Merge the rows
  metacommunity() %>% 
  # Numeric vector
  as.numeric() %>% 
  # Return alpha
  fisher.alpha() ->
  gf_alpha_guyadiv
# Marcon et al. (2024) results
c <- 694
z <- .104
gf_density <- 627 * 100
gf_area <- 8E4
# Number of species according to Guyadiv alpha
gf_ls_species <- gf_alpha_guyadiv * log(1 + gf_density * gf_area / gf_alpha_guyadiv)
# alpha according to the power model
library("untb")
gf_alpha_arrhenius <- fishers.alpha(
  N = gf_density * gf_area, 
  S = c * gf_area^z
)
ggplot(data.frame(x = 10^(1:6)), aes(x)) +
  geom_function(fun = \(A) c * A^z) +
  scale_x_log10() +
  geom_vline(
    xintercept = gf_area, 
    linetype = 2
  ) +
  geom_hline(
    yintercept = c * gf_area^z, 
    linetype = 2
  ) +
  # Accumulation curve of log-series
  geom_function(
    fun = \(A) {gf_alpha_guyadiv * log(1 + A * gf_density / gf_alpha_guyadiv)}, 
    col = "blue"
  ) +
  geom_function(
    fun = \(A) {gf_alpha_arrhenius * log(1 + A * gf_density / gf_alpha_arrhenius)}, 
    col = "red"
  ) +
  labs(x = "Area", y = "Number of species")
```

Number of tree species depending on the area (in square km, with density 627 trees/ha) in French Guiana, according to the Arrhenius's power model estimated by @Marcon2024.
The Y-axis is not in logarithm, so the relation is a convex curve instead of a straight line.
The black dotted lines show the valid estimation of richness in the whole territory: around 2200 species for 80,000 km^2^.
The green line is the species accumulation curve of the log-series estimated from the GuyaDiv metacommunity assuming its area is that of French Guiana.
It overestimates the regional biodiversity at all scales.
The red curve is the SAC of the actual metacommunity of French Guiana, whose Fisher's $\alpha$ is twice smaller.
:::

This theoretical result can be verified empirically with the GuyaDiv network plots in French Guiana.
In @fig-guyadiv_alpha, an increasing number of plots (one per site) is randomly selected to sample the metacommunity.
The estimated $\alpha$ are plotted against the number of plots.
Clearly, $\alpha$ increases linearly with the logarithm of the number of plots that is a proxy of the size of the sampled metacommunity.

::: {#fig-guyadiv_alpha}
```{r}
#| label: guyadiv_alpha
# Function to randomly select a plot in each of a
# chosen number of sites (sample_size), merge the plots and return alpha.
guyadiv_sub_alpha <- function(sample_size) {
  # Select one plot per location...
  guyadiv_plots %>% 
    # Set a random value to each plot
    mutate(random = runif(n())) %>% 
    {. ->> plots_randomized} %>% 
    group_by(Location) %>%
    # Select the plot with the max random value in each location
    summarize(random_max = max(random)) %>% 
    rename(random = random_max) %>% 
    # Eliminate non-selected plots
    inner_join(plots_randomized) %>% 
    # Keep the plot number and the random number
    dplyr::select(Plot, random) %>% 
    # Get the abundances
    inner_join(guyadiv_abd) %>% 
    # Sort by random number
    arrange(random) %>% 
    # Keep the first rows
    head(sample_size) %>% 
    # Delete the random numbers
    dplyr::select(-random) %>% 
    # Make the table an adundance object (package divent)
    rename(site = Plot) %>% 
    as_abundances() %>% 
    # Give all plots equal weight
    mutate(weight = 1) %>% 
    # Merge the inventories
    metacommunity() %>% 
    # Extract a numeric vector
    as.numeric() %>% 
    # Compute alpha
    fisher.alpha()
}

# Count the number of sites
guyadiv_plots %>% 
  group_by(Location) %>% 
  summarize() %>% 
  nrow() ->
  sites_n
# Choose sized between 1 and the number of sites
sizes <- seq_len(sites_n)[-(1:2)]
# Calculate alpha of each sample
alphas <- replicate(
  simulations_n,
  expr = sapply(sizes, FUN = guyadiv_sub_alpha)
)
tibble(NbPlots = sizes) %>%
  bind_cols(alphas) %>% 
  pivot_longer(cols = !NbPlots) %>% 
  ggplot(aes(x = NbPlots, y = value)) +
  geom_point() +
  scale_x_log10() +
  labs(x = "Number of Plots", y = "Fisher's alpha") +
  geom_smooth(method = "lm") +
  ggpubr::stat_regline_equation()
```

Estimation of the metacommunity's $\alpha$ as a function of the number of GuyaDiv plots used to sample it.
The line is the fit of the linear model relating $\alpha$ to the logarithm of the number of plots.
:::

The metacommunity GuyaDiv is a sample of largely exceeds the borders of French Guiana.
Its estimated $\alpha$ equals `r round(gf_alpha_guyadiv)`, implying more than 4000 tree species in the territory based on the number of trees: 627 per hectare on average multiplied by 8 million hectares.
Its SAC is shown on @fig-arrhenius_logx .
The actual number of species in French Guiana was obtained by the estimation of the power model [@Marcon2024]: it is close to 2200.
The correct estimate of $\alpha$ is thus only `r round(gf_alpha_arrhenius)`.

This example illustrates the impossibility to estimate $\alpha$ at a regional scale from sample plots, e.g. to compare the diversity of adjacent regions.
Log-series can be sampled, but the size of the metacommunities can't be controlled.
Of course, this issue vanishes when the metacommunity under study is bounded, e.g. the Amazon sampled by @TerSteege2013 to estimate its total number of species.
In this case, adding samples necessarily leads to an asymptotic estimation of $\alpha$.

# Conclusion

Despite its popularity as an index of diversity, Fisher's $\alpha$ should not be applied to tropical forest communities because it is the parameter of a model that does not fit the data.
According to the neutral theory, log-series communities would result from migration parameter 1, i.e. in the absence of dispersal limitation of the species of the metacommunity, which never occurs.
Forcing the estimation of $\alpha$ in non-log-series distributions results in highly scale-dependent values that seriously question the comparisons between communities based on their $\alpha$ index.

At the regional scale, metacommunities do follow log-series distributions so $\alpha$ can be estimated from a set of scattered forest plots, even though the spatial structure of species may introduce estimation biases.
Even ignoring this issue, $\alpha$ can't be interpreted simply because it is not possible to characterize the area of the sampled metacommunity.
At this scale, the measure is correct, but the measured object is unclear.

Finally, the empirical interest of Fisher's $\alpha$ is limited to the distribution of clearly delimited metacommunities, such as the Amazon forest as a whole.
In this context, it allowed among other results to estimate the number of tree species.
